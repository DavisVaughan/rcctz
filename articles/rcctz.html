<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using rcctz • rcctz</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using rcctz">
<meta property="og:description" content="rcctz">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rcctz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rcctz.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DavisVaughan/rcctz/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="rcctz_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using rcctz</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DavisVaughan/rcctz/blob/master/vignettes/rcctz.Rmd"><code>vignettes/rcctz.Rmd</code></a></small>
      <div class="hidden name"><code>rcctz.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>rcctz exposes a small but extremely useful API for working with time zones from C++. To use it from your own package, there are a few steps involved.</p>
<p>First, both import and link to rcctz. This can be done easily with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu">usethis</span><span class="fu">::</span><span class="fu">use_package</span><span class="op">(</span><span class="st">"rcctz"</span>, type <span class="op">=</span> <span class="st">"Imports"</span><span class="op">)</span>
<span class="fu">usethis</span><span class="fu">::</span><span class="fu">use_package</span><span class="op">(</span><span class="st">"rcctz"</span>, type <span class="op">=</span> <span class="st">"LinkingTo"</span><span class="op">)</span></pre></div>
<p>Next, you’ll need to ensure that rcctz is loaded completely when your package is loaded by a user. This registers the rcctz C callables that the API calls out to. To do this, add an <code><a href="https://rdrr.io/r/base/ns-hooks.html">.onLoad()</a></code> hook that looks like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">.onLoad</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">libname</span>, <span class="va">pkgname</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"rcctz"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span></pre></div>
<p>This should be enough to start using rcctz. There is a <code>rcctz.h</code> header provided that gives complete access to the API. Inside that header is a <code>rcctz::</code> namespace, everything in this namespace comprises the API of rcctz. It attempts to mirror the API of CCTZ as closely as possible.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>For a quick example, here is how we could use rcctz with cpp11. You can call <code>usethis::use_cpp11()</code> to set up cpp11 for your own package. In this Rmd document, I’ve used a cpp11 knitr code chunk and I’ve linked to rcctz with the attribute <code>[[cpp11::linking_to("rcctz")]]</code>. You won’t need to do that in package code because you’ll have added rcctz to LinkingTo already.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1"></a><span class="pp">#include </span><span class="im">&lt;cpp11.hpp&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="pp">#include </span><span class="im">&lt;rcctz.h&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>[[<span class="at">cpp11</span>::<span class="at">linking_to</span>(<span class="st">"rcctz"</span>)]]</span>
<span id="cb3-5"><a href="#cb3-5"></a>[[<span class="at">cpp11</span>::<span class="at">register</span>]]</span>
<span id="cb3-6"><a href="#cb3-6"></a>cpp11::doubles lookup_origin(cpp11::strings tzone) {</span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="co">// Construct a "civil time" object, which is separate from any time zone</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>  rcctz::civil_day cd = rcctz::civil_day(<span class="dv">1970</span>, <span class="dv">1</span>, <span class="dv">1</span>);</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="co">// "Load" the user specified time zone into a `rcctz::time_zone` object</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  rcctz::time_zone tz;</span>
<span id="cb3-12"><a href="#cb3-12"></a>  <span class="bu">std::</span>string cpp_tz = rcctz::tz_from_tzone(tzone);</span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="cf">if</span> (!rcctz::tz_load(cpp_tz, &amp;tz)) {</span>
<span id="cb3-14"><a href="#cb3-14"></a>    cpp11::stop(<span class="st">"Failed to load time zone."</span>);</span>
<span id="cb3-15"><a href="#cb3-15"></a>  }</span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a>  <span class="co">// "Lookup" the civil time in the user supplied time zone. This finds</span></span>
<span id="cb3-18"><a href="#cb3-18"></a>  <span class="co">// the numeric "absolute time" of that particular time in the specified time</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>  <span class="co">// zone. The absolute time is the number of seconds since 1970-01-01 in UTC.</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>  rcctz::time_zone::civil_lookup cl = tz.lookup(cd);</span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a>  <span class="co">// Construct a POSIXct object</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>  cpp11::writable::doubles out(<span class="dv">1</span>);</span>
<span id="cb3-24"><a href="#cb3-24"></a>  out.attr(<span class="st">"class"</span>) = {<span class="st">"POSIXct"</span>, <span class="st">"POSIXt"</span>};</span>
<span id="cb3-25"><a href="#cb3-25"></a>  out.attr(<span class="st">"tzone"</span>) = cpp_tz;</span>
<span id="cb3-26"><a href="#cb3-26"></a>  </span>
<span id="cb3-27"><a href="#cb3-27"></a>  <span class="co">// Dig into the civil_lookup to get the actual number of seconds since</span></span>
<span id="cb3-28"><a href="#cb3-28"></a>  <span class="co">// an origin of 1970-01-01 UTC, this is our POSIXct value</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>  out[<span class="dv">0</span>] = cl.trans.time_since_epoch().count();</span>
<span id="cb3-30"><a href="#cb3-30"></a></span>
<span id="cb3-31"><a href="#cb3-31"></a>  <span class="cf">return</span> out;</span>
<span id="cb3-32"><a href="#cb3-32"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">lookup_origin</span><span class="op">(</span><span class="st">"America/New_York"</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">lookup_origin</span><span class="op">(</span><span class="st">"Europe/Lisbon"</span><span class="op">)</span>

<span class="co"># These have the same clock time</span>
<span class="va">x</span>
<span class="co">#&gt; [1] "1970-01-01 EST"</span>
<span class="va">y</span>
<span class="co">#&gt; [1] "1970-01-01 CET"</span>

<span class="co"># But very different numeric representations (i.e. absolute times)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; [1] 18000</span>
<span class="co">#&gt; attr(,"tzone")</span>
<span class="co">#&gt; [1] "America/New_York"</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; [1] -3600</span>
<span class="co">#&gt; attr(,"tzone")</span>
<span class="co">#&gt; [1] "Europe/Lisbon"</span></pre></div>
</div>
<div id="skipped-and-repeated-dates" class="section level2">
<h2 class="hasAnchor">
<a href="#skipped-and-repeated-dates" class="anchor"></a>Skipped and repeated dates</h2>
<p>One neat thing about <code>tz.lookup()</code> with a civil time is that you get information about whether or not that date actually existed in the time zone used. You can use this information to make decisions about what to return in these corner cases.</p>
<p>In this example, we create a simple version of <code>lubridate::force_tz()</code> that handles skipped/repeated dates.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1"></a><span class="pp">#include </span><span class="im">&lt;cpp11.hpp&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="pp">#include </span><span class="im">&lt;rcctz.h&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a>[[<span class="at">cpp11</span>::<span class="at">linking_to</span>(<span class="st">"rcctz"</span>)]]</span>
<span id="cb5-5"><a href="#cb5-5"></a>[[<span class="at">cpp11</span>::<span class="at">register</span>]]</span>
<span id="cb5-6"><a href="#cb5-6"></a>cpp11::doubles force_tz(cpp11::doubles x, cpp11::strings tzone) {</span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="cf">if</span> (x.size() != <span class="dv">1</span>) {</span>
<span id="cb5-8"><a href="#cb5-8"></a>    cpp11::stop(<span class="st">"This example should take an input of size 1."</span>);</span>
<span id="cb5-9"><a href="#cb5-9"></a>  }</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="dt">int64_t</span> val = (<span class="dt">int64_t</span>) x[<span class="dv">0</span>];</span>
<span id="cb5-12"><a href="#cb5-12"></a>  rcctz::seconds sec(val);</span>
<span id="cb5-13"><a href="#cb5-13"></a>  rcctz::seconds_point sp(sec);</span>
<span id="cb5-14"><a href="#cb5-14"></a></span>
<span id="cb5-15"><a href="#cb5-15"></a>  rcctz::time_zone tz_from;</span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="bu">std::</span>string cpp_tz_from = rcctz::tz_from_tzone(x.attr(<span class="st">"tzone"</span>));</span>
<span id="cb5-17"><a href="#cb5-17"></a>  <span class="cf">if</span> (!rcctz::tz_load(cpp_tz_from, &amp;tz_from)) {</span>
<span id="cb5-18"><a href="#cb5-18"></a>    cpp11::stop(<span class="st">"Failed to load time zone."</span>);</span>
<span id="cb5-19"><a href="#cb5-19"></a>  }</span>
<span id="cb5-20"><a href="#cb5-20"></a></span>
<span id="cb5-21"><a href="#cb5-21"></a>  rcctz::time_zone tz_to;</span>
<span id="cb5-22"><a href="#cb5-22"></a>  <span class="bu">std::</span>string cpp_tz_to = rcctz::tz_from_tzone(tzone);</span>
<span id="cb5-23"><a href="#cb5-23"></a>  <span class="cf">if</span> (!rcctz::tz_load(cpp_tz_to, &amp;tz_to)) {</span>
<span id="cb5-24"><a href="#cb5-24"></a>    cpp11::stop(<span class="st">"Failed to load time zone."</span>);</span>
<span id="cb5-25"><a href="#cb5-25"></a>  }</span>
<span id="cb5-26"><a href="#cb5-26"></a></span>
<span id="cb5-27"><a href="#cb5-27"></a>  <span class="co">// Convert absolute number of seconds to a civil time free of any time zones</span></span>
<span id="cb5-28"><a href="#cb5-28"></a>  rcctz::civil_second cs = rcctz::convert(sp, tz_from);</span>
<span id="cb5-29"><a href="#cb5-29"></a></span>
<span id="cb5-30"><a href="#cb5-30"></a>  <span class="co">// Convert that civil time over to a</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>  <span class="co">// time-zone-specific absolute number of seconds</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>  rcctz::time_zone::civil_lookup cl = tz_to.lookup(cs);</span>
<span id="cb5-33"><a href="#cb5-33"></a></span>
<span id="cb5-34"><a href="#cb5-34"></a>  cpp11::writable::doubles out(<span class="dv">1</span>);</span>
<span id="cb5-35"><a href="#cb5-35"></a>  out.attr(<span class="st">"class"</span>) = {<span class="st">"POSIXct"</span>, <span class="st">"POSIXt"</span>};</span>
<span id="cb5-36"><a href="#cb5-36"></a>  out.attr(<span class="st">"tzone"</span>) = cpp_tz_to;</span>
<span id="cb5-37"><a href="#cb5-37"></a></span>
<span id="cb5-38"><a href="#cb5-38"></a>  <span class="co">// There is no guarantee that `x` exists in the new time zone, so we have</span></span>
<span id="cb5-39"><a href="#cb5-39"></a>  <span class="co">// to check `cl.kind` and adapt accordingly</span></span>
<span id="cb5-40"><a href="#cb5-40"></a>  <span class="cf">switch</span> (cl.kind) {</span>
<span id="cb5-41"><a href="#cb5-41"></a>  <span class="cf">case</span> rcctz::time_zone::civil_lookup::UNIQUE: {</span>
<span id="cb5-42"><a href="#cb5-42"></a>    <span class="co">// It did exist, and was unique</span></span>
<span id="cb5-43"><a href="#cb5-43"></a>    out[<span class="dv">0</span>] = cl.trans.time_since_epoch().count();</span>
<span id="cb5-44"><a href="#cb5-44"></a>    <span class="cf">break</span>;</span>
<span id="cb5-45"><a href="#cb5-45"></a>  }</span>
<span id="cb5-46"><a href="#cb5-46"></a>  <span class="cf">case</span> rcctz::time_zone::civil_lookup::SKIPPED: {</span>
<span id="cb5-47"><a href="#cb5-47"></a>    <span class="co">// That time does not exist in this time zone. We are in a DST gap!</span></span>
<span id="cb5-48"><a href="#cb5-48"></a>    <span class="co">// Choose to return NA here.</span></span>
<span id="cb5-49"><a href="#cb5-49"></a>    out[<span class="dv">0</span>] = NA_REAL;</span>
<span id="cb5-50"><a href="#cb5-50"></a>    <span class="cf">break</span>;</span>
<span id="cb5-51"><a href="#cb5-51"></a>  }</span>
<span id="cb5-52"><a href="#cb5-52"></a>  <span class="cf">case</span> rcctz::time_zone::civil_lookup::REPEATED: {</span>
<span id="cb5-53"><a href="#cb5-53"></a>    <span class="co">// The time existed, but is ambiguous due to DST fallbacks</span></span>
<span id="cb5-54"><a href="#cb5-54"></a>    <span class="co">// We default to choosing the time computed using the</span></span>
<span id="cb5-55"><a href="#cb5-55"></a>    <span class="co">// pre-transition UTC offset</span></span>
<span id="cb5-56"><a href="#cb5-56"></a>    out[<span class="dv">0</span>] = cl.pre.time_since_epoch().count();</span>
<span id="cb5-57"><a href="#cb5-57"></a>    <span class="cf">break</span>;</span>
<span id="cb5-58"><a href="#cb5-58"></a>  }</span>
<span id="cb5-59"><a href="#cb5-59"></a>  }</span>
<span id="cb5-60"><a href="#cb5-60"></a></span>
<span id="cb5-61"><a href="#cb5-61"></a>  <span class="cf">return</span> out;</span>
<span id="cb5-62"><a href="#cb5-62"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"2020-01-01"</span>, tz <span class="op">=</span> <span class="st">"America/New_York"</span><span class="op">)</span>
<span class="va">x</span>
<span class="co">#&gt; [1] "2020-01-01 EST"</span>

<span class="co"># Force the same clock time in a different time zone</span>
<span class="fu">force_tz</span><span class="op">(</span><span class="va">x</span>, <span class="st">"Australia/Queensland"</span><span class="op">)</span>
<span class="co">#&gt; [1] "2020-01-01 AEST"</span></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"1970-04-26 02:20:00"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>

<span class="co"># This time didn't exist in this time zone because there was a DST gap.</span>
<span class="co"># One second after 01:59:59, the time jumped 1 hour forward to 03:00:00.</span>
<span class="fu">force_tz</span><span class="op">(</span><span class="va">x</span>, <span class="st">"America/New_York"</span><span class="op">)</span>
<span class="co">#&gt; [1] NA</span></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"1970-10-25 01:20:00"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>

<span class="co"># This time actually exists twice in this time zone. Once during EDT and</span>
<span class="co"># again during EST. One second after 01:59:59, the clocks rolled back 1 hour</span>
<span class="co"># and it was again 01:00:00. In these cases we have decided to always use</span>
<span class="co"># the pre-transition UTC offset for computing the time, which gives us the</span>
<span class="co"># "first" occurrence of that time</span>
<span class="fu">force_tz</span><span class="op">(</span><span class="va">x</span>, <span class="st">"America/New_York"</span><span class="op">)</span>
<span class="co">#&gt; [1] "1970-10-25 01:20:00 EDT"</span>

<span class="co"># Here is the second, 1 hour later</span>
<span class="fu">force_tz</span><span class="op">(</span><span class="va">x</span>, <span class="st">"America/New_York"</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span>
<span class="co">#&gt; [1] "1970-10-25 01:20:00 EST"</span></pre></div>
</div>
<div id="caveats-and-restrictions" class="section level2">
<h2 class="hasAnchor">
<a href="#caveats-and-restrictions" class="anchor"></a>Caveats and restrictions</h2>
<p>There are a few extra things to know about the <code>rcctz::</code> namespace, especially if you already know how to use CCTZ.</p>
<p>First off, when you <code>#include &lt;rcctz.h&gt;</code> this actually gives you access to the <code>cctz::</code> namespace as well. Please do not use it. Functions like <code>cctz::convert()</code> will not work, as you only have access to the headers, not the implementations. You should be able to create all of the CCTZ objects you need with the rcctz namespace.</p>
<p>CCTZ has templated variants for <code>cctz::convert()</code> and <code>cctz::time_zone::lookup()</code> that take a <code>time_point&lt;T&gt;</code>, where <code>T</code> is a duration type like seconds or hours. It seems impossible to create a C callable for a template function like this, so rcctz has chosen to only expose the explicit variant for seconds. This is all that is generally required by R packages anyways. rcctz exposes <code>rcctz::seconds_point</code> as an alias of <code>time_point&lt;cctz::seconds&gt;</code> which should be used with the non-template versions of <code>rcctz::convert()</code> and <code>rcctz::time_zone::lookup()</code>.</p>
<p>CCTZ has <code>cctz::load_time_zone()</code>. In rcctz, the way to do this is with <code>rcctz::tz_load()</code>. This has some special behavior when the local time zone is needed that is specific to R.</p>
<p>While not obviously apparent, arithmetic can be performed on the civil period objects like <code>rcctz::civil_day</code> and <code>rcctz::civil_second</code>. The arithmetic is done at the period level of the specified type (i.e. <code>&lt;civil_day&gt; + 2</code> would add two days).</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Davis Vaughan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
